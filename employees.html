<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ - –ö–æ–≤—à–µ–π-–°–µ—Ä–≤–∏—Å</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        nav {
            background: #34495e;
            padding: 0;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            justify-content: center;
        }

        .nav-menu li {
            margin: 0;
        }

        .nav-menu a {
            color: white;
            text-decoration: none;
            padding: 20px 30px;
            display: block;
            transition: background 0.3s;
            font-weight: 500;
        }

        .nav-menu a:hover {
            background: #2c3e50;
        }

        .nav-menu a.active {
            background: #3498db;
        }

        .page-header {
            padding: 30px 40px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .page-header h1 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .content {
            padding: 40px;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            gap: 20px;
        }

        .search-bar {
            display: flex;
            flex: 1;
            max-width: 400px;
        }

        .search-bar input {
            flex: 1;
            padding: 12px 20px;
            border: 1px solid #ddd;
            border-radius: 8px 0 0 8px;
            font-size: 1em;
        }

        .search-bar button {
            padding: 12px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .employees-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .employee-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .employee-card:hover {
            transform: translateY(-5px);
        }

        .employee-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .employee-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: #3498db;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            margin-right: 20px;
        }

        .employee-info h3 {
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1.3em;
        }

        .employee-position {
            color: #7f8c8d;
            font-size: 1em;
        }

        .employee-details {
            margin-bottom: 20px;
        }

        .detail-row {
            display: flex;
            margin: 8px 0;
        }

        .detail-label {
            font-weight: bold;
            color: #2c3e50;
            min-width: 120px;
        }

        .detail-value {
            color: #555;
        }

        .role-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            margin-right: 8px;
        }

        .role-employee { background: #95a5a6; color: white; }
        .role-manager { background: #e74c3c; color: white; }
        .role-procurement { background: #f39c12; color: white; }
        .role-admin { background: #9b59b6; color: white; }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .status-active { background: #27ae60; color: white; }
        .status-inactive { background: #95a5a6; color: white; }

        .employee-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.9em;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .departments-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .department-stat {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .department-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .employee-count {
            font-size: 1.8em;
            font-weight: bold;
            color: #3498db;
        }

        footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
        }

        @media (max-width: 768px) {
            .employees-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-bar {
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">üõ†Ô∏è –ö–û–í–®–ï–ô-–°–ï–†–í–ò–°</div>
            <div class="subtitle">–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —Ä–µ–º–æ–Ω—Ç–∞ –∫–æ–≤—à–µ–π</div>
        </header>

        <nav>
            <ul class="nav-menu">
                <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="requests.html">–ó–∞—è–≤–∫–∏</a></li>
                <li><a href="materials.html">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</a></li>
                <li><a href="reports.html">–û—Ç—á–µ—Ç—ã</a></li>
                <li><a href="employees.html" class="active">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a></li>
                <li><a href="login.html">–í—Ö–æ–¥</a></li>
            </ul>
        </nav>

        <div class="page-header">
            <h1>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</h1>
            <p>–°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–∏—Å—Ç–µ–º–µ</p>
        </div>

        <div class="content">
            <div class="controls">
                <div class="search-bar">
                    <input type="text" placeholder="üîç –ü–æ–∏—Å–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...">
                    <button>–ù–∞–π—Ç–∏</button>
                </div>
                <button class="btn btn-success">+ –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
            </div>

            <div class="employees-grid">
                <div class="employee-card">
                    <div class="employee-header">
                        <div class="employee-avatar">–ò–ê</div>
                        <div class="employee-info">
                            <h3>–ò–≤–∞–Ω–æ–≤ –ê–ª–µ–∫—Å–µ–π –ü–µ—Ç—Ä–æ–≤–∏—á</h3>
                            <div class="employee-position">–°–≤–∞—Ä—â–∏–∫ 5 —Ä–∞–∑—Ä—è–¥–∞</div>
                        </div>
                    </div>
                    <div class="employee-details">
                        <div class="detail-row">
                            <span class="detail-label">–û—Ç–¥–µ–ª:</span>
                            <span class="detail-value">–¶–µ—Ö —Å–≤–∞—Ä–∫–∏ –∏ –Ω–∞–ø–ª–∞–≤–∫–∏</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">ivanov@kovshey-service.ru</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">–†–æ–ª—å:</span>
                            <span class="role-badge role-employee">–°–æ—Ç—Ä—É–¥–Ω–∏–∫</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">–°—Ç–∞—Ç—É—Å:</span>
                            <span class="status-badge status-active">–ê–∫—Ç–∏–≤–µ–Ω</span>
                        </div>
                    </div>
                    <div class="employee-actions">
                        <button class="btn btn-primary btn-sm">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-warning btn-sm">–°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                    </div>
                </div>

                <div class="employee-card">
                    <div class="employee-header">
                        <div class="employee-avatar">–ü–°</div>
                        <div class="employee-info">
                            <h3>–ü–µ—Ç—Ä–æ–≤ –°–µ—Ä–≥–µ–π –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á</h3>
                            <div class="employee-position">–ù–∞—á–∞–ª—å–Ω–∏–∫ —Ü–µ—Ö–∞</div>
                        </div>
                    </div>
                    <div class="employee-details">
                        <div class="detail-row">
                            <span class="detail-label">–û—Ç–¥–µ–ª:</span>
                            <span class="detail-value">–¶–µ—Ö —Å–≤–∞—Ä–∫–∏ –∏ –Ω–∞–ø–ª–∞–≤–∫–∏</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">petrov@kovshey-service.ru</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">–†–æ–ª—å:</span>
                            <span class="role-badge role-manager">–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">–°—Ç–∞—Ç—É—Å:</span>
                            <span class="status-badge status-active">–ê–∫—Ç–∏–≤–µ–Ω</span>
                        </div>
                    </div>
                    <div class="employee-actions">
                        <button class="btn btn-primary btn-sm">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-warning btn-sm">–°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                    </div>
                </div>

                <div class="employee-card">
                    <div class="employee-header">
                        <div class="employee-avatar">–°–ú</div>
                        <div class="employee-info">
                            <h3>–°–∏–¥–æ—Ä–æ–≤–∞ –ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–Ω–∞</h3>
                            <div class="employee-position">–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –∑–∞–∫—É–ø–∫–∞–º</div>
                        </div>
                    </div>
                    <div class="employee-details">
                        <div class="detail-row">
                            <span class="detail-label">–û—Ç–¥–µ–ª:</span>
                            <span class="detail-value">–û—Ç–¥–µ–ª –∑–∞–∫—É–ø–æ–∫</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">sidorova@kovshey-service.ru</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">–†–æ–ª—å:</span>
                            <span class="role-badge role-procurement">–ó–∞–∫—É–ø–∫–∏</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">–°—Ç–∞—Ç—É—Å:</span>
                            <span class="status-badge status-active">–ê–∫—Ç–∏–≤–µ–Ω</span>
                        </div>
                    </div>
                    <div class="employee-actions">
                        <button class="btn btn-primary btn-sm">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-warning btn-sm">–°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                    </div>
                </div>

                <div class="employee-card">
                    <div class="employee-header">
                        <div class="employee-avatar">–ö–î</div>
                        <div class="employee-info">
                            <h3>–ö–æ–∑–ª–æ–≤ –î–º–∏—Ç—Ä–∏–π –ê–Ω–∞—Ç–æ–ª—å–µ–≤–∏—á</h3>
                            <div class="employee-position">–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                        </div>
                    </div>
                    <div class="employee-details">
                        <div class="detail-row">
                            <span class="detail-label">–û—Ç–¥–µ–ª:</span>
                            <span class="detail-value">IT –æ—Ç–¥–µ–ª</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">admin@kovshey-service.ru</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">–†–æ–ª—å:</span>
                            <span class="role-badge role-admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">–°—Ç–∞—Ç—É—Å:</span>
                            <span class="status-badge status-active">–ê–∫—Ç–∏–≤–µ–Ω</span>
                        </div>
                    </div>
                    <div class="employee-actions">
                        <button class="btn btn-primary btn-sm">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-warning btn-sm">–°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                    </div>
                </div>
            </div>

            <div class="departments-stats">
                <div class="department-stat">
                    <div class="department-name">–¶–µ—Ö —Å–≤–∞—Ä–∫–∏ –∏ –Ω–∞–ø–ª–∞–≤–∫–∏</div>
                    <div class="employee-count">8</div>
                    <div>—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                </div>
                <div class="department-stat">
                    <div class="department-name">–û—Ç–¥–µ–ª –∑–∞–∫—É–ø–æ–∫</div>
                    <div class="employee-count">3</div>
                    <div>—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                </div>
                <div class="department-stat">
                    <div class="department-name">–û–¢–ö</div>
                    <div class="employee-count">5</div>
                    <div>—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                </div>
                <div class="department-stat">
                    <div class="department-name">IT –æ—Ç–¥–µ–ª</div>
                    <div class="employee-count">2</div>
                    <div>—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</div>
                </div>
            </div>
        </div>

        <footer>
            <p>¬© 2024 –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∞–º–∏ "–ö–æ–≤—à–µ–π-–°–µ—Ä–≤–∏—Å". –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </footer>
    </div>

    <script src="app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (!window.appData) {
                loadData().then(() => initEmployeesPage());
            } else {
                initEmployeesPage();
            }
        });

        function initEmployeesPage() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            if (!checkPageAccess(['manager', 'procurement', 'admin'])) {
                return;
            }
            
            updateEmployeesList();
            
            // –ü–æ–∏—Å–∫
            const searchInput = document.querySelector('.search-bar input');
            const searchBtn = document.querySelector('.search-bar button');
            searchBtn.addEventListener('click', () => {
                const query = searchInput.value;
                const filtered = searchEmployees(query);
                displayEmployees(filtered);
            });
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const query = searchInput.value;
                    const filtered = searchEmployees(query);
                    displayEmployees(filtered);
                }
            });

            // –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
            const addBtn = document.querySelector('.btn-success');
            if (addBtn && hasPermission('canAddEmployee')) {
                addBtn.addEventListener('click', () => showEmployeeForm());
            } else if (addBtn) {
                addBtn.style.display = 'none';
            }
        }

        function updateEmployeesList() {
            displayEmployees(window.appData.employees || []);
        }

        function displayEmployees(employees) {
            const grid = document.querySelector('.employees-grid');
            grid.innerHTML = '';
            
            employees.forEach(employee => {
                const card = createEmployeeCard(employee);
                grid.appendChild(card);
            });
        }

        function createEmployeeCard(employee) {
            const card = document.createElement('div');
            card.className = 'employee-card';
            const initials = (employee.firstName[0] + employee.lastName[0]).toUpperCase();
            
            card.innerHTML = `
                <div class="employee-header">
                    <div class="employee-avatar">${initials}</div>
                    <div class="employee-info">
                        <h3>${employee.lastName} ${employee.firstName} ${employee.middleName}</h3>
                        <div class="employee-position">${employee.position}</div>
                    </div>
                </div>
                <div class="employee-details">
                    <div class="detail-row">
                        <span class="detail-label">–û—Ç–¥–µ–ª:</span>
                        <span class="detail-value">${employee.department}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Email:</span>
                        <span class="detail-value">${employee.email}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">–†–æ–ª—å:</span>
                        <span class="role-badge role-${employee.role}">${getRoleText(employee.role)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">–°—Ç–∞—Ç—É—Å:</span>
                        <span class="status-badge status-${employee.status}">${employee.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}</span>
                    </div>
                </div>
                <div class="employee-actions">
                    ${hasPermission('canEditEmployee') ? `<button class="btn btn-primary btn-sm" onclick="editEmployee('${employee.id}')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>` : ''}
                    ${hasPermission('canResetPassword') ? `<button class="btn btn-warning btn-sm" onclick="resetPassword('${employee.id}')">–°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>` : ''}
                </div>
            `;
            return card;
        }

        function showEmployeeForm(employee = null) {
            const isEdit = !!employee;
            const content = `
                <form id="employeeForm" style="display: flex; flex-direction: column; gap: 15px;">
                    <div><label style="display: block; margin-bottom: 5px; font-weight: bold;">–ò–º—è:</label>
                    <input type="text" id="emp-firstName" value="${employee ? employee.firstName : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></div>
                    <div><label style="display: block; margin-bottom: 5px; font-weight: bold;">–§–∞–º–∏–ª–∏—è:</label>
                    <input type="text" id="emp-lastName" value="${employee ? employee.lastName : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></div>
                    <div><label style="display: block; margin-bottom: 5px; font-weight: bold;">–û—Ç—á–µ—Å—Ç–≤–æ:</label>
                    <input type="text" id="emp-middleName" value="${employee ? employee.middleName : ''}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></div>
                    <div><label style="display: block; margin-bottom: 5px; font-weight: bold;">–î–æ–ª–∂–Ω–æ—Å—Ç—å:</label>
                    <input type="text" id="emp-position" value="${employee ? employee.position : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></div>
                    <div><label style="display: block; margin-bottom: 5px; font-weight: bold;">–û—Ç–¥–µ–ª:</label>
                    <input type="text" id="emp-department" value="${employee ? employee.department : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></div>
                    <div><label style="display: block; margin-bottom: 5px; font-weight: bold;">Email:</label>
                    <input type="email" id="emp-email" value="${employee ? employee.email : ''}" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></div>
                    <div><label style="display: block; margin-bottom: 5px; font-weight: bold;">–†–æ–ª—å:</label>
                    <select id="emp-role" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <option value="employee" ${employee && employee.role === 'employee' ? 'selected' : ''}>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</option>
                        <option value="manager" ${employee && employee.role === 'manager' ? 'selected' : ''}>–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</option>
                        <option value="procurement" ${employee && employee.role === 'procurement' ? 'selected' : ''}>–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –∑–∞–∫—É–ø–∫–∞–º</option>
                        <option value="admin" ${employee && employee.role === 'admin' ? 'selected' : ''}>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                    </select></div>
                </form>
            `;
            
            createModal(isEdit ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞' : '–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞', content, [
                { text: '–û—Ç–º–µ–Ω–∞', onclick: 'closeModal()', class: 'btn-secondary' },
                { text: isEdit ? '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' : '–î–æ–±–∞–≤–∏—Ç—å', onclick: `saveEmployeeForm('${employee ? employee.id : ''}')`, class: 'btn-success' }
            ]);
        }

        function saveEmployeeForm(employeeId) {
            if (employeeId && !hasPermission('canEditEmployee')) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.');
                return;
            }
            if (!employeeId && !hasPermission('canAddEmployee')) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.');
                return;
            }
            
            const employeeData = {
                firstName: document.getElementById('emp-firstName').value,
                lastName: document.getElementById('emp-lastName').value,
                middleName: document.getElementById('emp-middleName').value,
                position: document.getElementById('emp-position').value,
                department: document.getElementById('emp-department').value,
                email: document.getElementById('emp-email').value,
                role: document.getElementById('emp-role').value
            };
            
            if (employeeId) {
                const result = updateEmployee(employeeId, employeeData);
                if (result.success) {
                    alert('–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω!');
                    closeModal();
                    updateEmployeesList();
                }
            } else {
                const result = addEmployee(employeeData);
                if (result.success) {
                    alert('–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω!');
                    closeModal();
                    updateEmployeesList();
                }
            }
        }

        function editEmployee(id) {
            if (!hasPermission('canEditEmployee')) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.');
                return;
            }
            const employee = window.appData.employees.find(e => e.id === id);
            if (employee) showEmployeeForm(employee);
        }

        function resetPassword(id) {
            if (!hasPermission('canResetPassword')) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª–µ–π.');
                return;
            }
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è —ç—Ç–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞?')) {
                const result = resetEmployeePassword(id);
                if (result.success) {
                    alert(`–ü–∞—Ä–æ–ª—å —Å–±—Ä–æ—à–µ–Ω! –ù–æ–≤—ã–π –≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å: ${result.password}`);
                }
            }
        }
    </script>
</body>
</html>